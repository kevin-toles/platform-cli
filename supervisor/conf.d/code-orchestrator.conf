; =============================================================================
; Code-Orchestrator Service Configuration
; =============================================================================
; WBS-LOG1.4: code-orchestrator.conf service definition
; Port: 8083
; Service: Sous Chef - HuggingFace model hosting (SBERT, CodeT5+, CodeBERT, GraphCodeBERT)
;
; References:
; - UNIFIED_KITCHEN_BRIGADE_ARCHITECTURE.md Section 7.2
; - D10: Retry N + Skip (step) + Circuit Breaker (service)
; =============================================================================

[program:code-orchestrator]
command=/Users/kevintoles/POC/Code-Orchestrator-Service/.venv/bin/python -m uvicorn src.main:app --host 0.0.0.0 --port 8083
directory=/Users/kevintoles/POC/Code-Orchestrator-Service
user=kevintoles
autostart=true
autorestart=true
startsecs=60
stopwaitsecs=90
startretries=3
exitcodes=0

; Logging (AC-LOG1.2)
; Previously logs went to stdout only - now centralized for Loki ingestion
stdout_logfile=/Users/kevintoles/Library/Logs/ai-platform/code-orchestrator/stdout.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile=/Users/kevintoles/Library/Logs/ai-platform/code-orchestrator/stderr.log
stderr_logfile_maxbytes=10MB
stderr_logfile_backups=5
redirect_stderr=false

; Environment variables (AC-LOG0.4)
environment=
    CODE_ORCHESTRATOR_LOG_LEVEL="INFO",
    PYTHONUNBUFFERED="1",
    PYTHONPATH="/Users/kevintoles/POC/Code-Orchestrator-Service",
    LOG_JSON="true"

; Process priority (lower = start earlier)
; Code-Orchestrator depends on inference and gateway, so starts later
priority=400

